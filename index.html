<!doctype html>
<html lang="tr">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Şantiye Hatalı İmalat</title>
<style>
body{font-family:system-ui;background:#111;color:#eee;margin:0}
.wrap{max-width:700px;margin:auto;padding:16px}
label{display:block;margin-top:12px;color:#aaa}
input,select,textarea,button{width:100%;padding:12px;margin-top:6px;background:#1b1b1b;color:#fff;border:1px solid #333;border-radius:8px}
button{margin-top:14px;background:#2b7cff;border:none}
</style>
</head>
<body>
<div class="wrap">
<h2>Hatalı İmalat (Offline)</h2>

<label>Ada</label>
<select id="ada"><option>1.ADA</option><option>2.ADA</option></select>

<label>Blok</label>
<input id="blok">

<label>Kat</label>
<select id="kat"><option>1.KAT</option><option>2.KAT</option></select>

<label>İmalat</label>
<select id="imalat"><option>DUVAR</option><option>BOYA</option></select>

<label>Açıklama</label>
<textarea id="aciklama"></textarea>

<label>Foto</label>
<input type="file" id="foto" accept="image/*" capture>

<button onclick="kaydet()">Kaydet (Offline)</button>
<button onclick="gonder()">Gönder</button>

<p id="durum"></p>
</div>

<script>
const URL = "https://script.google.com/macros/s/AKfycbycdbgff4_pGzZ6bYb2VUqTQnaW_mY9k5IcHy_QPFzHi9S0lfUpB63aCiPQzDibbpt6/exec";

function kaydet(){
  const f = document.getElementById("foto").files[0];
  const r = new FileReader();
  r.onload = ()=>{
    localStorage.setItem("k", JSON.stringify({
      ada:ada.value, blok:blok.value, kat:kat.value,
      imalat:imalat.value, aciklama:aciklama.value,
      photo:r.result
    }));
    durum.innerText="Offline kaydedildi";
  };
  r.readAsDataURL(f);
}

function gonder(){
  const d = JSON.parse(localStorage.getItem("k"));
  if(!d){durum.innerText="Kayıt yok";return;}

  const form = document.createElement("form");
  form.method="POST";
  form.action=URL;
  form.target="_blank";

  const i=document.createElement("input");
  i.name="payload";
  i.value=JSON.stringify(d);
  form.appendChild(i);

  document.body.appendChild(form);
  form.submit();
  durum.innerText="Gönderildi. Sheet/Drive kontrol et.";
}
</script>
</body>
</html>
